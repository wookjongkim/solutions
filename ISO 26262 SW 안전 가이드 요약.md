## 배경
차량의 기능 및 운행 제어에 대한 전자시스템 및 SW에 대한 의존성이 높아지고 차량 내부 통신망이 발달함에 따라 `비 기계적 요소에 의한 차량의 안전 저해 가능성이 높아진 상황`<br>
-> 이러한 기술적 변화에 따라 차량에 탑재되는 전기전자시스템의 안전을 확보하기 위한 새로운 개발 패러다임으로 `기능 안전(Functional Safety)` 개념이 차량 전자제어 시스템 개발에 적용되고 있음<br>
<br>
기능안전 모표준인 `IEC 61508`을 근간으로 2011년 `ISO 26262`를 제정<br>
-> 전세계 완성차 제조사(OEM)와 부품사가 참여하여 개발되었으며, 전 세계 주요 OEM은 기능안전을 확보한 시스템 개발을 위해 ISO 26262에 대한 요구사항을 포함하여 부품사에게 부품 개발을 요구하고 있음<br>
-> 이를 위해 OEM은 기능안전요구사항과 이들의 ASIL(Automotive Safety Integrity Level, 자동차 안전 무결성 등급)을 정의하고 부품사들이 이에 따라 ISO 26262 표준을 준수하여 제품을 개발하여 공급하도록 요구<br>
<br>
ISO 26262는 기능안전 확보를 위한 기법과 목표 기준만을 제시하고, 구체적인 도구와 방법은 제시하지 않음<br>
-> 큰 기업의 경우엔 문제가 없지만, 국내 중소 SW 기업들의 경우 자체적으로 표준을 해석하는데 어려움<br>
<br>
`갈수록 하드웨어 oriented 되어 있는 분야에서 sw에 대한 의존도가 높아지고 있음` <br>
-> 하드웨어 장치 중심의 기능 오작동에 대한 대응만으로는 전체적인 기능 안전을 확보할 수 없게 됨. 기능 안전에서 소프트웨어 안전의 역할과 중요성이 커지고 있음<br>
<br>

---

## 자동차 SW 특징
자동차는 순수 기계장치로 탄생했지만, 현재 자동차 회사들은 기계 기술로 해결하지 못하는 안전, 환경 규제와 사용자 편의성 제공위해 전기전자 기술과 소프트웨어 기술을 적극적으로 사용<br>
-> ex) 차선 유지 보조, 자동 긴급 제동 시스템과 같은 ADAS(첨단 운전자 보조) 시스템은 모두 SW로 구현됨<br>
<br>
고속으로 운행하는 자동차의 특성 상, 제어 소프트웨어의 오작동이 치명적인 손실로 이어질 수 있다.<br>
-> 네비게이션과 같은 인포테인먼트 SW의 경우도 간접적으로 운전자를 방해할 수 있기에 세심한 설계 필요함<br>
<br>

`산업 구조 측면에서 자동차 SW는 완성차 회사 혹은 부품사(Tier-N)의 발주에 의해 맞춤형으로 개발되는 경우가 대부분` <br>
-> 비슷한 기능을 하는 SW의 경우에도 차종과 연식별로 상이한 요구사항을 가지고 있기 때문<br>
-> 자주 변하는 요구사항에 잘 대응해야 하고, 안전도 확보해야 함<br>
<br>

자동차 SW 개발 측면에서도 소스 코드를 개발자가 직접 작성하지 않고 다이어그램 형태의 모델로부터 자동 생성해서 사용하는 `MBD(Model Based Design)` 방법을 많이 사용<br>
고속으로 움직이는 자동차에 연결되어 동작하기에 동작을 멈추고 디버깅하는 방식을 사용할 수도 없음 -> 자동차 SW 개발 분야가 대단히 독특한 분야임을 반증<br>
<br>

---

## 자동차 SW 분류
자동차에 탑재되는 SW는 크게 `IVI(In-Vehicle infotainment)` 시스템을 위한 SW와 `차량 제어 시스템`을 위한 소프트웨어로 구분할 수 있다<br>

- IVI : 오디오,비디오 같은 멀티미디어 기능과 GPS 네비게이션 등을 포함
- 차량제어 시스템 : 엔진, 조향장치, 제동장치와 같이 자동차의 움직임을 제어하는 기계 부품들과 연결되어 동작

차량제어 시스템이 더 높은 수준의 안전 요구사항을 필요로 함<br>
멀티미디어 기능의 경우 상대적으로 낮은 안전 요구사항을 가지는 반면, 인스트루먼트 클러스터(Instrument Cluster)의 경우 더 높은 안전이 요구되고 제동 장치를 제어하는 제어기는 훨씬 높은 안전이 요구됨<br>

차량 제어 시스템은 크게 `파워트레인(Powertrain)`, `샤시(Chassis)`, `바디(Body)` 도메인으로 나뉜다<br>

- `파워트레인` : 엔진이 생성한 동력을 바퀴로 전달하여 자동차가 움직이게 만드는 시스템입니다.(엔진, 변속기와 같은거)
- `샤시` : 자동차의 차체를 뺀 나머지 부분으로 주행의 원동력이 되는 엔진을 비롯하여 동력전달장치, 조향장치, 현가장치, 제동 장치 등이 있습니다.
- `바디` : 자동차의 기계부품과 승객을 보호하도록 설계된 자동차의 외관 구조물을 지칭함

### 각 도메인에서 사용되는 SW
파워트레인의 경우 `EMS`(Engine Management System : 엔진을 제어하는 시스템), `TMS`(Transmission Management System : 변속기 제어 시스템)를 중요한 구성 요소로 포함<br>
샤시 도메인의 경우 횡방향 안정성 강화하는 `ESC(Electronic Stability Control)`

---

## 자동차 SW 구조
자동차 SW 중 AVN(Audio, Video, and Navigation)시스템의 경우 응용 SW와 유사한 구조<br>
-> 차량 제어 SW의 경우에는 일반적인 모바일 or PC 소프트웨어와 전혀 다른 구조를 가지고 있어야 함<br>
<br>
원래 차량 제어 소프트웨어의 구조는 회사별로 독자적으로 발전해 옴<br>
-> 이러한 배경에서 자동차 SW의 재사용성을 높이고, 응용 소프트웨어에 영량을 집중하기 위해 `AUTOSAR(Automotive Open System Architecture)`라는 자동차 제어 표준을 만듬<br>
<br>
![image](https://github.com/wookjongkim/solutions/assets/121083077/f179a10b-2c5f-46a4-984a-818b70bec96a)
하드웨어 위에 표준화된 BSW(Basic Software) 계층, RTE 계층을 올려서 그 위에서 동작하는 ASW는 AUTOSAR 표준에 맞춰서 개발되면 하드웨어가 변경되더라도 호환성을 유지할 수 있음<br>
<br>
AUTOSAR는 영상처리, 인공지능, Connectivity, OTA(Over the Air) 등 최신 분야에 대한 기술 지원이 안됨<br>
-> 이에 대한 대응으로 리눅스와 같은 POLSIX 표준에 따르는 운영체제를 가정한 새로운 AUTOSAR 표준인 `Adaptive AUTOSAR` 표준이 2017년 발표<br>
<br>

---

## 자동차 sw 관련 산업구조
완성차 회사(OEM)을 정점으로 부품사(Tier-N)들이 협력하는 피라미드 구조를 가짐<br>

![image](https://github.com/wookjongkim/solutions/assets/121083077/14bd73f8-baec-4050-9848-c76fde278ff6)
완성차 회사에 직접 부품을 공급하는 회사를 Tier-1이라 하고, Tier-1에 부품을 공급하는 회사를 Tier-2라고 함<br>
<br>

자동차 SW 기술은 부품사들을 중심으로 발전해 옴<br>
-> 독일의 거대 부품사들은 오랜 기간 동안 SW개발 경험을 바탕으로 AUTOSAR, ISO 26262, Automotive SPICE 등 자동차 소프트웨어 관련 막대한 영향력<br>
<br>
자동차 SW는 부품사와 그 협력사에 의해 개발되어 완성차 회사에 부품, 모듈, 시스템 형태로 납품되는 경우가 대부분<br>

---

## ISO 26262
![image](https://github.com/wookjongkim/solutions/assets/121083077/fc19d298-011c-4ea8-a012-463d97085dd9)

IEC 61508에서 파생된 표준으로 2011년에 발표된 자동차 전기전자 시스템을 위한 기능안전 표준입니다.(3.5톤 이하 양상 승용차만을 대상으로 함)<br>
<br>
보통 완성차 회사에서 안전 분석을 하여 어느 정도의 안전 등급을 유지해야 하는지 결정하고, 이에 따라 부품사는 등급별로 ISO 26262에 명시된 의무사항을 수행하고, 결과를 완성차 회사에 제출해야 함<br>
<br>
MISRA는 자동차 소프트웨어의 안전 확보를 위해 발표된 표준<br>
-> 처음에는 자동차를 타겟으로 하였지만, 지금은 항공 철도 국방 등 다양한 분야에서도 많이 사용되는 중<br>
<br>


---

## A-SPICE
![image](https://github.com/wookjongkim/solutions/assets/121083077/7d223e1d-ca17-4da8-880c-be2ab352b137)

Automotive SPICE(A-SPICE)는 ISO/IEC 15504 및 ISO/IEC 12207을 기반으로 자동차 임베디드 시스템 개발에 맞게 특화하여 만든 국제 표준 프로세스 참조 및 평가 모델입니다.<br>
<br>
자동차에서 소프트웨어의 비중이 커져가면서 SW 개발에 대한 신뢰성을 확보하기 힘들다는 완성차 회사들의 판단으로 자동차 소프트웨어 개발 프로세스의 정립 및 평가가 필요했음<br>
-> 이때 CMMI나 SPICE와 같은 기존 프로세스 모델을 도입하여 해결 하고자 했음<br>
<br>
독일 자동차 협회(VDA)에서 라이센스 비용, 변경 용이성 고려해서 2005년 SPICE 기반으로 A-SPICE 1.0 발표<br>
<br>
많은 완성차 회사들, 특히 독일 자동차 협회를 중심으로 한 회사들은 Tier-1 부품사에게 필수적으로 A-SPICE 레벨 2~3을 유지하도록 강하게 요구하고 있<br>
<br>

---

## ASIL 등급 분류

![image](https://github.com/wookjongkim/solutions/assets/121083077/6ab1ad96-9ffe-4ef7-ab04-91a31aaf054a)

---

## SW 안전 개발 기준 단계 모델(V모델)

![image](https://github.com/wookjongkim/solutions/assets/121083077/8822c2d1-7774-47f9-b922-250ec8cc6406)

---

## MIL(Model In the Loop), SIL(SW In the Loop), PIL(Precessor In the Loop)
![image](https://github.com/wookjongkim/solutions/assets/121083077/5248ca63-7696-4814-98eb-e16b86acbd24)

MIL에서 PIL로 갈수록 시뮬레이션 결과가 실제 제어기 환경에 가까워짐

- `MIL` : 제어 대상과 제어기가 모두 PC에서 개발된 그래픽 모델을 이요하여 시뮬레이션 됨
- `SIL` : 제어 대상은 MIL 방법과 동일하나, 제어기 모델은 코드가 생성되어 PC에서 컴파일 된 후 실행됨
- `PIL` : 제어 코드가 임베디드 보드에서 실행됨

---

## HIL(Hardware-In-the-Loop)
ECU를 검증할때 가장 정확한 방법은 ECU를 완성된 차량에 직접 연결하여 테스트하는 것<br>
-> 하지만 검증 초기 단계에 실차를 이용할 경우 실차 준비전 테스트 불가, ECU 오동작이 실험 인원에 위험초래할 수도<br>
<br>
따라서 효율적인 ECU 초기 검증을 수행하기 위해 개발 됨<br>
<br>
HIL 테스트 환경은 검증 대상 ECU와 HIL 시뮬레이터로 구성되어 있음<br>
-> HIL 시뮬레이터는 물리 시스템 즉 실차를 모사하는 가상 환경 제공, 여기 연결된 ECU는 실차에 연결된 것 같은 입출력 시그널을 주고받게 됨 <br>
-> 예를들어 엔진 ECU를 테스트할때는 연료분사, 폭발, 배기와 같은 엔진의 물리적인 움직임을 모사하는 엔진 HIL 시뮬레터 사용됨<br>
-> 시뮬레이션 환경이기 때문에 위험하거나 드물게 발생하는 경우의 수를 만들어 테스트 가능<br>
<br>
ECU는 독자적으로 동작하는 경우가 드물고 다른 ECU들과 협조하면서 동작핳는 경우가 많음(ex: 다른 ECU의 도움 없이는 테스트케이스 실행이 불가능한 경우도 있다)<br>
<br>






























